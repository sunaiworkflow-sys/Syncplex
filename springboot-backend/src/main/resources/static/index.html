<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SyncPlex • JD → Resume</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        .hidden {
            display: none !important;
        }

        /* Custom scrollbar for dark mode aesthetics */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: #3f3f46;
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #52525b;
        }

        .skill-tag {
            display: inline-block;
            padding: 2px 8px;
            font-size: 11px;
            font-weight: 500;
            border-radius: 6px;
            background: rgba(14, 165, 233, 0.1);
            color: #0ea5e9;
            border: 1px solid rgba(14, 165, 233, 0.2);
        }

        .dark .skill-tag {
            background: rgba(14, 165, 233, 0.15);
            color: #38bdf8;
            border-color: rgba(14, 165, 233, 0.3);
        }
    </style>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        zinc: {
                            850: '#1f1f22',
                            950: '#09090b',
                        }
                    }
                }
            }
        }
    </script>
</head>

<body class="bg-zinc-50 text-zinc-900 dark:bg-zinc-950 dark:text-zinc-100 min-h-screen transition-colors duration-200"
    id="appBody">

    <!-- Top bar -->
    <nav class="sticky top-0 z-40 border-b border-zinc-200 bg-white/70 dark:border-zinc-800 dark:bg-zinc-950/70 backdrop-blur"
        id="topBar">
        <div class="mx-auto flex max-w-7xl items-center justify-between px-4 py-3">
            <div class="flex items-center gap-3">
                <div class="h-9 w-9 rounded-xl grid place-items-center border border-zinc-200 bg-white dark:border-zinc-800 dark:bg-zinc-900"
                    id="brandLogo">
                    <span class="text-sm font-semibold">SP</span>
                </div>
                <div>
                    <div class="text-sm font-semibold">SyncPlex • JD → Resume</div>
                    <div class="text-xs text-zinc-500 dark:text-zinc-400">Recruiter workspace</div>
                </div>
            </div>

            <div class="flex items-center gap-2">
                <button id="themeToggleBtn"
                    class="flex items-center gap-2 rounded-xl border border-zinc-200 bg-white px-3 py-2 text-sm transition hover:bg-zinc-50 dark:border-zinc-800 dark:bg-zinc-900 dark:hover:bg-zinc-800">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                        stroke="currentColor" class="h-4 w-4">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z" />
                    </svg>
                    <span>Light</span>
                </button>

                <div class="flex items-center gap-2 rounded-xl border border-zinc-200 bg-white dark:border-zinc-800 dark:bg-zinc-900 px-3 py-2"
                    id="userProfile">
                    <div class="h-7 w-7 rounded-full bg-gradient-to-br from-sky-400 to-indigo-500"></div>
                    <div class="leading-tight">
                        <div class="text-xs font-semibold">Signed in</div>
                        <div class="text-[11px] text-zinc-500 dark:text-zinc-400">Gmail OAuth</div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Layout -->
    <div class="mx-auto grid max-w-7xl grid-cols-1 gap-4 px-4 py-4 md:grid-cols-[280px_1fr]">

        <!-- Sidebar -->
        <aside class="rounded-2xl border border-zinc-200 bg-white dark:border-zinc-800 dark:bg-zinc-900/60 p-3"
            id="sidebar">
            <div class="flex items-center justify-between gap-2 mb-3">
                <div>
                    <div class="text-sm font-semibold">Jobs</div>
                    <div class="text-xs text-zinc-500 dark:text-zinc-400">Each job is a workspace</div>
                </div>
                <button id="newJobBtn"
                    class="flex items-center gap-2 rounded-xl bg-zinc-900 px-3 py-2 text-sm font-medium text-zinc-50 transition hover:bg-zinc-800 dark:bg-zinc-100 dark:text-zinc-900 dark:hover:bg-white">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2"
                        stroke="currentColor" class="h-4 w-4">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                    </svg>
                    New
                </button>
            </div>

            <div id="jobsList" class="space-y-2 max-h-[calc(100vh-280px)] overflow-y-auto pr-1">
                <!-- Job items will be injected here -->
            </div>

            <div class="mt-4 rounded-xl border border-zinc-200 dark:border-zinc-800 p-3" id="tipBox">
                <div class="text-xs font-semibold">Tip</div>
                <div class="mt-1 text-xs text-zinc-500 dark:text-zinc-400">
                    Name the job clearly (client + role + location). This makes ranking history easy.
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="rounded-2xl border border-zinc-200 bg-white dark:border-zinc-800 dark:bg-zinc-900/60"
            id="mainPanel">

            <!-- Header -->
            <div class="border-b border-zinc-200 dark:border-zinc-800 p-4" id="mainHeader">
                <div class="flex flex-col gap-3 md:flex-row md:items-center md:justify-between">
                    <div>
                        <div class="text-base font-semibold" id="activeJobTitleDisplay">Job</div>
                        <div class="text-sm text-zinc-500 dark:text-zinc-400">
                            Upload JD → Extract skills → Rank resumes
                        </div>
                    </div>
                    <div class="flex items-center gap-2">
                        <input id="jobTitleInput"
                            class="w-full md:w-64 rounded-xl border border-zinc-200 bg-zinc-50 px-3 py-2 text-sm focus:outline-none focus:border-zinc-400 dark:border-zinc-800 dark:bg-zinc-950/40 dark:focus:border-zinc-700"
                            placeholder="Job name" value="">
                        <span id="statusBadge"
                            class="text-[10px] px-2 py-1 rounded-full bg-zinc-100 text-zinc-600 dark:bg-zinc-800 dark:text-zinc-400">Status:
                            idle</span>
                    </div>
                </div>
            </div>

            <!-- Content Area -->
            <div class="p-4 space-y-4">

                <!-- Top Row: JD and Resume Upload -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">

                    <!-- JD Section -->
                    <section id="jdSection"
                        class="rounded-2xl border border-zinc-200 dark:border-zinc-800 p-4 bg-zinc-50/50 dark:bg-zinc-900/40">
                        <div class="flex items-start justify-between gap-2 mb-3">
                            <div>
                                <div class="text-sm font-semibold">Job Description</div>
                                <div id="jdHelperText" class="text-xs text-zinc-500 dark:text-zinc-400">Upload PDF or
                                    paste text</div>
                            </div>
                            <div class="flex items-center gap-2">
                                <input type="file" id="jdFileInput" accept=".pdf,.doc,.docx,.txt" class="hidden">

                                <button id="saveJdBtn"
                                    class="px-3 py-1.5 rounded-lg text-xs font-medium border border-sky-200 bg-sky-50 text-sky-600 hover:bg-sky-100 dark:border-sky-900/30 dark:bg-sky-900/20 dark:text-sky-400">
                                    Save
                                </button>
                                <button id="clearJdBtn"
                                    class="hidden px-3 py-1.5 rounded-lg text-xs font-medium border border-red-200 bg-red-50 text-red-600 hover:bg-red-100 dark:border-red-900/30 dark:bg-red-900/20 dark:text-red-400">
                                    Clear
                                </button>
                            </div>
                        </div>

                        <!-- File Upload Box -->
                        <div id="jdFileInfoBox" class="mb-3">
                            <div id="jdFilePlaceholder"
                                class="cursor-pointer rounded-xl border border-dashed border-zinc-300 bg-white py-6 text-center transition hover:bg-zinc-50 dark:border-zinc-700 dark:bg-zinc-900/30 dark:hover:bg-zinc-800/50">
                                <span class="text-xs font-medium text-zinc-500 dark:text-zinc-400">Click to Upload or
                                    Drop JD file here</span>
                            </div>
                            <div id="jdFileDetails" class="hidden">
                                <div id="jdFileName" class="text-sm font-semibold"></div>
                                <div id="jdFileSize" class="text-xs text-zinc-500"></div>
                            </div>
                        </div>

                        <div>
                            <label id="jdPasteLabel"
                                class="text-xs font-semibold text-zinc-500 dark:text-zinc-400 mb-1 block">Or paste
                                text</label>
                            <textarea id="jdTextArea"
                                class="h-44 w-full resize-none rounded-xl border border-zinc-200 bg-white p-3 text-sm focus:border-sky-500 focus:outline-none placeholder-zinc-400 dark:border-zinc-800 dark:bg-zinc-950/40 dark:focus:border-sky-500/60 dark:placeholder-zinc-600"
                                placeholder="Paste job description here..."></textarea>
                        </div>
                    </section>

                    <!-- Resume Section -->
                    <section id="resumeSection"
                        class="rounded-2xl border border-zinc-200 dark:border-zinc-800 p-4 bg-zinc-50/50 dark:bg-zinc-900/40">
                        <div class="flex items-start justify-between gap-2 mb-3">
                            <div>
                                <div class="text-sm font-semibold">Resumes</div>
                                <div class="text-xs text-zinc-500 dark:text-zinc-400">
                                    Uploaded: <span id="resumeCount"
                                        class="font-bold text-zinc-900 dark:text-zinc-100">0</span>
                                </div>
                            </div>
                            <div class="flex items-center gap-2">
                                <input type="file" id="resumeFileInput" multiple accept=".pdf,.doc,.docx"
                                    class="hidden">
                                <input type="file" id="resumeFolderInput" webkitdirectory directory multiple
                                    class="hidden">

                                <button id="uploadResumeBtn"
                                    class="p-2 rounded-xl border border-zinc-200 bg-white hover:bg-zinc-100 dark:border-zinc-700 dark:bg-zinc-800 dark:hover:bg-zinc-700 text-zinc-600 dark:text-zinc-300"
                                    title="Upload Files">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                        stroke-width="1.5" stroke="currentColor" class="h-4 w-4">
                                        <path stroke-linecap="round" stroke-linejoin="round"
                                            d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m3.75 9v6m3-3H9m1.5-12H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" />
                                    </svg>
                                </button>
                                <button id="folderUploadBtn"
                                    class="p-2 rounded-xl border border-zinc-200 bg-white hover:bg-zinc-100 dark:border-zinc-700 dark:bg-zinc-800 dark:hover:bg-zinc-700 text-sky-600 dark:text-sky-400"
                                    title="Upload Folder">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                        stroke-width="1.5" stroke="currentColor" class="h-4 w-4">
                                        <path stroke-linecap="round" stroke-linejoin="round"
                                            d="M2.25 12.75V12A2.25 2.25 0 014.5 9.75h15A2.25 2.25 0 0121.75 12v.75m-8.69-6.44l-2.12-2.12a1.5 1.5 0 00-1.061-.44H4.5A2.25 2.25 0 002.25 6v12a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9a2.25 2.25 0 00-2.25-2.25h-5.379a1.5 1.5 0 01-1.06-.44z" />
                                    </svg>
                                </button>
                                <button id="importDriveBtn"
                                    class="p-2 rounded-xl border border-zinc-200 bg-white hover:bg-zinc-100 dark:border-zinc-700 dark:bg-zinc-800 dark:hover:bg-zinc-700 text-green-600 dark:text-green-500"
                                    title="Link Google Drive">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                        stroke-width="1.5" stroke="currentColor" class="h-4 w-4">
                                        <path stroke-linecap="round" stroke-linejoin="round"
                                            d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244" />
                                    </svg>
                                </button>
                            </div>
                        </div>

                        <!-- Resume List -->
                        <div id="resumesList"
                            class="max-h-64 overflow-y-auto pr-1 space-y-2 border-t border-zinc-200 dark:border-zinc-800 pt-3">
                            <div class="italic text-zinc-500 text-sm py-4 text-center">No resumes uploaded yet.</div>
                        </div>
                    </section>

                </div>

                <!-- JD Requirements Display (After Extraction) -->
                <div id="jdRequirementsSection"
                    class="hidden rounded-xl border border-violet-200 dark:border-violet-900/50 bg-gradient-to-r from-violet-50 to-purple-50 dark:from-violet-950/30 dark:to-purple-950/30 p-4">
                    <div class="flex items-start justify-between mb-3">
                        <div class="flex items-center gap-2">
                            <div class="h-8 w-8 rounded-lg bg-violet-100 dark:bg-violet-900/50 grid place-items-center">
                                <svg class="w-4 h-4 text-violet-600 dark:text-violet-400" fill="none"
                                    stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                            </div>
                            <div>
                                <div class="text-sm font-semibold text-violet-800 dark:text-violet-200">JD Requirements
                                    Extracted</div>
                                <div class="text-xs text-violet-600/70 dark:text-violet-400/70">Skills and experience
                                    needed for this role</div>
                            </div>
                        </div>
                        <div id="expBadge"
                            class="hidden px-3 py-1.5 rounded-full bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-400 text-xs font-semibold flex items-center gap-1">
                            <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            <span id="expYearsDisplay">0+ years</span>
                        </div>
                    </div>

                    <!-- Required Skills -->
                    <div class="mb-3">
                        <div
                            class="text-xs font-semibold text-violet-700 dark:text-violet-300 mb-2 flex items-center gap-2">
                            <span
                                class="px-1.5 py-0.5 rounded bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 text-[10px]">REQUIRED</span>
                            <span id="requiredSkillsCount" class="text-zinc-500 dark:text-zinc-400 font-normal">0
                                skills</span>
                        </div>
                        <div id="requiredSkillsList" class="flex flex-wrap gap-1.5">
                            <!-- Skills tags injected here -->
                        </div>
                    </div>

                    <!-- Preferred Skills -->
                    <div id="preferredSkillsSection" class="hidden">
                        <div
                            class="text-xs font-semibold text-violet-700 dark:text-violet-300 mb-2 flex items-center gap-2">
                            <span
                                class="px-1.5 py-0.5 rounded bg-emerald-100 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-400 text-[10px]">PREFERRED</span>
                            <span id="preferredSkillsCount" class="text-zinc-500 dark:text-zinc-400 font-normal">0
                                skills</span>
                        </div>
                        <div id="preferredSkillsList" class="flex flex-wrap gap-1.5">
                            <!-- Preferred skills tags injected here -->
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div
                    class="flex items-center justify-between gap-4 p-3 rounded-xl bg-zinc-100/50 dark:bg-zinc-800/30 border border-zinc-200 dark:border-zinc-800">
                    <div id="skillsDisplay" class="hidden flex-1 overflow-x-auto whitespace-nowrap">
                        <span class="text-xs font-semibold text-zinc-500 mr-2">REQUIRED:</span>
                        <div id="skillsList" class="inline-flex gap-1"></div>
                    </div>
                    <div id="resultsPlaceholder" class="flex-1 text-zinc-400 text-xs italic">
                        Click "Extract Skills" to analyze JD requirements, then "Match & Rank" to find best candidates.
                    </div>

                    <div class="flex items-center gap-3 flex-none">

                        <button id="rankBtn"
                            class="group flex items-center gap-2 bg-gradient-to-r from-sky-500 to-cyan-500 text-white px-5 py-2.5 rounded-xl text-sm font-semibold hover:from-sky-600 hover:to-cyan-600 shadow-lg shadow-sky-500/25 transition-all disabled:opacity-50 disabled:cursor-not-allowed disabled:shadow-none">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                            </svg>
                            Match & Rank
                        </button>
                    </div>
                </div>

                <!-- Results Section (Rank Table goes here) -->
                <div id="resultsContent" class="min-h-[200px]">
                    <!-- Table injected here by JS -->
                </div>

            </div>
        </main>

    </div>

    <!-- Drive Import Modal -->
    <div id="driveModal"
        class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm opacity-0 pointer-events-none transition-opacity duration-300">
        <div
            class="w-full max-w-lg scale-95 transform rounded-2xl bg-white p-6 shadow-2xl transition-all duration-300 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800">
            <div class="flex items-center justify-between mb-4">
                <div class="flex items-center gap-2">
                    <div
                        class="grid h-8 w-8 place-items-center rounded-lg bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor">
                            <path
                                d="M12.01 1.5c-1.28 0-2.34.82-2.75 1.99l-4.19 12.3c-.15.44.17.91.64.91h2.72c.42 0 .78-.28.91-.68l.65-1.92h8.02l.66 1.92c.13.4.49.68.91.68h2.72c.47 0 .79-.47.64-.91l-4.19-12.3c-.41-1.17-1.47-1.99-2.75-1.99zm0 3.39L15.44 12h-6.86L12.01 4.89z"
                                opacity=".2" />
                        </svg>
                    </div>
                    <div class="text-lg font-bold text-zinc-900 dark:text-zinc-100">Import from Google Drive</div>
                </div>
                <button id="driveModalClose"
                    class="rounded-lg p-2 text-zinc-500 hover:bg-zinc-100 dark:text-zinc-400 dark:hover:bg-zinc-800">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd"
                            d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                            clip-rule="evenodd" />
                    </svg>
                </button>
            </div>

            <div class="space-y-4">
                <div class="rounded-xl bg-sky-50 p-4 text-sm text-sky-800 dark:bg-sky-900/30 dark:text-sky-300">
                    <p class="font-semibold mb-1">Make your Link Public (or shared with system)</p>
                    <ol class="list-decimal pl-4 space-y-1 text-xs opacity-90">
                        <li>Right-click your Google Drive folder/file.</li>
                        <li>Select <strong>Share</strong> > <strong>Share</strong>.</li>
                        <li>Under <em>General Access</em>, verify it is <strong>"Anyone with the link"</strong> OR
                            shared with <strong>krish23306@gmail.com</strong>.</li>
                        <li>Click <strong>Copy Link</strong> and paste it below.</li>
                    </ol>
                </div>

                <div>
                    <label class="mb-1.5 block text-xs font-semibold text-zinc-500 dark:text-zinc-400">Drive
                        Link</label>
                    <input type="text" id="driveLinkInput"
                        class="w-full rounded-xl border border-zinc-200 bg-zinc-50 px-3 py-2.5 text-sm focus:border-sky-500 focus:outline-none dark:border-zinc-700 dark:bg-zinc-800 dark:text-zinc-100 dark:focus:border-sky-500"
                        placeholder="https://drive.google.com/drive/folders/...">
                </div>

                <button id="driveScanBtn"
                    class="flex w-full items-center justify-center gap-2 rounded-xl bg-green-600 px-4 py-2.5 text-sm font-semibold text-white transition hover:bg-green-700 disabled:opacity-70 disabled:cursor-not-allowed">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
                    </svg>
                    Scan & Import
                </button>

                <div id="driveStatus" class="hidden text-center text-xs text-zinc-500 mt-2"></div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast"
        class="fixed bottom-4 left-1/2 z-50 w-[92vw] max-w-md -translate-x-1/2 translate-y-20 opacity-0 transition-all duration-300">
        <div
            class="rounded-2xl border border-zinc-200 bg-white dark:border-zinc-800 dark:bg-zinc-900 px-4 py-3 text-sm shadow-lg">
            <div class="flex items-start gap-3">
                <div id="toastIcon" class="mt-0.5 h-2.5 w-2.5 rounded-full bg-emerald-400"></div>
                <div class="min-w-0">
                    <div id="toastTitle" class="font-semibold text-zinc-900 dark:text-zinc-100">Notification</div>
                    <div id="toastMessage" class="mt-0.5 text-sm text-zinc-500 dark:text-zinc-400">Message content</div>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="app-v3.js"></script>
</body>

</html>